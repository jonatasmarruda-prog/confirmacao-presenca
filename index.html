<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Confirma√ß√£o de Presen√ßa - √înibus</title>

  <style>
    :root{
      --bg:#0b0b0c;
      --card:#121215;
      --accent:#16a34a;
      --danger:#dc2626;
      --muted:#9aa0a6;
      --text:#ffffff;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,Arial;background:var(--bg);color:var(--text)}
    .app{max-width:780px;margin:0 auto;padding:16px}
    header{display:flex;align-items:center;gap:12px;flex-direction:column}
    h1{font-size:22px;margin:6px 0}
    .logo{width:120px;border-radius:8px}
    .status{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;justify-content:center}
    .chip{background:var(--card);padding:8px 12px;border-radius:12px;font-weight:700}
    .controls{display:flex;gap:8px;margin-top:12px}
    button.btn{flex:1;padding:12px;border-radius:10px;border:0;font-size:16px;font-weight:700;cursor:pointer}
    .btn-all{background:#1d1d20;color:var(--text)}
    .btn-confirm{background:var(--accent);color:#fff}
    .btn-missing{background:var(--danger);color:#fff}
    .list{margin-top:14px;background:var(--card);border-radius:12px;padding:6px}
    .item{display:flex;align-items:center;justify-content:space-between;padding:12px;border-bottom:1px solid rgba(255,255,255,0.07)}
    .item:last-child{border-bottom:0}
    .name{font-size:18px;font-weight:800}
    .confirm-btn{padding:10px 14px;border-radius:10px;border:0;font-weight:800;cursor:pointer}
    .confirmed{background:linear-gradient(90deg,#16a34a,#059669);color:#fff}
    .not-confirmed{background:transparent;border:2px dashed rgba(255,255,255,0.1);color:#fff}
    footer{text-align:center;margin-top:18px;color:var(--muted);font-size:14px}
  </style>
</head>
<body>

  <div class="app">

    <header>
      <img class="logo" src="https://i.imgur.com/MwHr761.png" alt="Logo Trilheiros" />
      <h1>Confirma√ß√£o de Presen√ßa - √înibus</h1>
      <div style="font-size:14px;color:var(--muted)">Clique no seu nome para confirmar ‚úîÔ∏è</div>
    </header>

    <div class="status">
      <div class="chip" id="total"></div>
      <div class="chip" id="confirmedCount"></div>
      <div class="chip" id="missingCount"></div>
    </div>

    <div class="controls">
      <button class="btn btn-all" id="showAll">Todos</button>
      <button class="btn btn-confirm" id="showConfirmed">Confirmados</button>
      <button class="btn btn-missing" id="showMissing">Faltantes</button>
    </div>

    <div class="list" id="list"></div>

    <footer>
      Atualiza√ß√£o em tempo real üîÑ ‚Äî usando Firebase Realtime Database
      <br>Organizado por Trilheiros de Rondon√≥polis
    </footer>

    <div style="text-align:center;margin-top:20px;">
      <button id="btnReset" style="padding:10px 14px;border-radius:10px;border:0;background:#222;color:#fff;">
        Resetar lista
      </button>
    </div>

  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAUssjdtiOs0oO9yhWV3dExsj7sGaB4jEA",
      authDomain: "onibus-morro-da-mesa.firebaseapp.com",
      databaseURL: "https://onibus-morro-da-mesa-default-rtdb.firebaseio.com",
      projectId: "onibus-morro-da-mesa",
      storageBucket: "onibus-morro-da-mesa.firebasestorage.app",
      messagingSenderId: "21597144482",
      appId: "1:21597144482:web:93a55c39d477e67c1d5efb",
      measurementId: "G-WP1BX1H1F0"
    };

    const names = [
      "Alysson","Ana Julia","Debora Betania","Debora Carla","Edivaldo","Eliana",
      "Elizangela","Elma","Flavia Yane","Gabriellen","Indrid Mirely","Isadora",
      "Izabel","Ivy","Jessica","Jessica Lorrayne","Joana","Jonatas Marcos",
      "Josiane","Junior","Livia","Lucas","Luciana","Luciene","Maria Nemis",
      "Maria Rafaela","Maria luisa","Nadir","Nayhany","Paula","Paula Francinete",
      "Shely","Silv√¢nia","Tamiris","Tatielen","Thaynan","Vitoria","Wallison"
    ];

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const ref = db.ref("presenca_onibus");

    const totalEl = document.getElementById("total");
    const listEl = document.getElementById("list");
    const confirmedEl = document.getElementById("confirmedCount");
    const missingEl = document.getElementById("missingCount");

    totalEl.textContent = "Total: " + names.length;

    ref.once("value").then(snap=>{
      if(!snap.exists()){
        const init = {};
        names.forEach(n=> init[n] = false);
        ref.set(init);
      }
    });

    ref.on("value", snap=>{
      const data = snap.val();
      renderList(data);
    });

    function toggle(name){
      ref.child(name).transaction(v => !v);
    }

    function renderList(data){
      listEl.innerHTML = "";
      let confirmed = 0;

      names.forEach(name=>{
        const ok = data[name];
        if(ok) confirmed++;

        const row = document.createElement("div");
        row.className = "item";

        const left = document.createElement("div");
        left.innerHTML = `<div class='name'>${name}</div>`;

        const btn = document.createElement("button");
        btn.className = "confirm-btn " + (ok ? "confirmed" : "not-confirmed");
        btn.textContent = ok ? "‚úîÔ∏è Confirmado" : "Confirmar";
        btn.onclick = ()=> toggle(name);

        row.appendChild(left);
        row.appendChild(btn);
        listEl.appendChild(row);
      });

      confirmedEl.textContent = "Confirmados: " + confirmed;
      missingEl.textContent = "Faltantes: " + (names.length - confirmed);
    }

    document.getElementById("showAll").onclick = ()=>{
      document.querySelector(".list").style.display = "block";
    };

    document.getElementById("showConfirmed").onclick = ()=>{
      [...listEl.children].forEach(div=>{
        div.style.display = div.querySelector("button").classList.contains("confirmed") ? "flex":"none";
      });
    };

    document.getElementById("showMissing").onclick = ()=>{
      [...listEl.children].forEach(div=>{
        div.style.display = div.querySelector("button").classList.contains("not-confirmed") ? "flex":"none";
      });
    };

    document.getElementById("btnReset").onclick = ()=>{
      if(confirm("Resetar confirma√ß√µes?")){
        const reset = {};
        names.forEach(n=> reset[n] = false);
        ref.set(reset);
      }
    };
  </script>

</body>
</html>
